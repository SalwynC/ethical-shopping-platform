"use strict";(()=>{var e={};e.id=825,e.ids=[825],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2716:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>v,patchFetch:()=>D,requestAsyncStorage:()=>S,routeModule:()=>y,serverHooks:()=>g,staticGenerationAsyncStorage:()=>w});var a={};s.r(a),s.d(a,{GET:()=>p,HEAD:()=>m,POST:()=>f,dynamic:()=>l,runtime:()=>u});var r=s(3277),n=s(5265),o=s(5356),i=s(7076);let l="force-dynamic",u="nodejs";class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}trackBrowserSession(e,t){this.activeBrowserSessions.set(e,{lastSeen:Date.now(),userAgent:t||"unknown"}),this.cleanExpiredSessions()}cleanExpiredSessions(){let e=Date.now()-12e4;this.activeBrowserSessions.forEach((t,s)=>{t.lastSeen<e&&this.activeBrowserSessions.delete(s)})}recordAnalysis(){let e=new Date().toDateString();this.lastDailyReset!==e&&(this.dailyAnalysesCount=0,this.totalAPICallsToday=0,this.lastDailyReset=e),this.dailyAnalysesCount++}recordAPICall(){let e=new Date().toDateString();this.lastDailyReset!==e&&(this.totalAPICallsToday=0,this.lastDailyReset=e),this.totalAPICallsToday++}getCurrentMetrics(){this.cleanExpiredSessions();let e=Math.floor((Date.now()-this.serverStartTime)/1e3);return{activeBrowsers:this.activeBrowserSessions.size,dailyAnalyses:this.dailyAnalysesCount,totalAPICallsToday:this.totalAPICallsToday,uptimeHours:Math.floor(e/3600),uptimeMinutes:Math.floor(e%3600/60)}}constructor(){this.activeBrowserSessions=new Map,this.dailyAnalysesCount=0,this.serverStartTime=Date.now(),this.lastDailyReset=new Date().toDateString(),this.totalAPICallsToday=0}}let d=c.getInstance();async function h(e,t){let s=performance.now();if(!t)return{status:"online",responseTime:Math.round(performance.now()-s),lastPing:new Date().toISOString()};try{let e=new AbortController,a=setTimeout(()=>e.abort(),3e3),r=await fetch(t,{method:"HEAD",signal:e.signal,cache:"no-cache"});clearTimeout(a);let n=Math.round(performance.now()-s);return{status:r.ok?"online":"offline",responseTime:n,lastPing:new Date().toISOString()}}catch(t){let e=Math.round(performance.now()-s);return{status:"offline",responseTime:e>3e3?3e3:e,lastPing:new Date().toISOString()}}}async function p(e){let t=performance.now();try{d.recordAPICall();let s=e.headers.get("x-session-id")||e.headers.get("x-forwarded-for")||`browser_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,a=e.headers.get("user-agent")||"unknown";d.trackBrowserSession(s,a);let r=d.getCurrentMetrics(),[n,o,l,u]=await Promise.allSettled([h("Frontend Server"),h("Backend API","http://localhost:4000/api/health"),h("Analytics Service","http://localhost:8001/health"),h("Database")]),c={"Frontend Server":{status:"online",responseTime:Math.round(performance.now()-t),lastPing:new Date().toISOString()},"Backend API":{status:"fulfilled"===o.status?o.value.status:"offline",responseTime:"fulfilled"===o.status?o.value.responseTime:0,lastPing:"fulfilled"===o.status?o.value.lastPing:new Date().toISOString()},"Analytics Service":{status:"fulfilled"===l.status?l.value.status:"offline",responseTime:"fulfilled"===l.status?l.value.responseTime:0,lastPing:"fulfilled"===l.status?l.value.lastPing:new Date().toISOString()},Database:{status:"fulfilled"===u.status?u.value.status:"offline",responseTime:"fulfilled"===u.status?u.value.responseTime:0,lastPing:"fulfilled"===u.status?u.value.lastPing:new Date().toISOString()}},p=Object.values(c).filter(e=>"online"===e.status).length,m=Math.round(p/Object.keys(c).length*100),f={timestamp:new Date().toISOString(),dailyAnalyses:r.dailyAnalyses,activeBrowsers:Math.max(1,r.activeBrowsers),systemHealth:m,uptime:{hours:r.uptimeHours,minutes:r.uptimeMinutes},services:c},y=Math.round(performance.now()-t),S=i.NextResponse.json({...f,meta:{processingTime:y,dataSource:"real-browser-analytics",cacheStatus:"no-cache",requestId:`real_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionId:s,isRealData:!0}});return S.headers.set("Cache-Control","no-cache, no-store, must-revalidate"),S.headers.set("Pragma","no-cache"),S.headers.set("Expires","0"),S.headers.set("X-Real-Analytics","true"),S.headers.set("X-Processing-Time",y.toString()),S}catch(t){let e=i.NextResponse.json({timestamp:new Date().toISOString(),dailyAnalyses:0,activeBrowsers:0,systemHealth:0,uptime:{hours:0,minutes:0},services:{},error:"Analytics system offline",meta:{dataSource:"error-state",isRealData:!0,errorMessage:t instanceof Error?t.message:"Unknown error"}},{status:500});return e.headers.set("Cache-Control","no-cache"),e}}async function m(e){return new Response(null,{status:200,headers:{"X-Service-Status":"operational","X-Real-Analytics":"enabled","X-Timestamp":new Date().toISOString()}})}async function f(e){try{let t=await e.json();if("record_analysis"===t.action)return d.recordAnalysis(),i.NextResponse.json({success:!0,message:"Analysis recorded",timestamp:new Date().toISOString()});return i.NextResponse.json({error:"Invalid action"},{status:400})}catch(e){return i.NextResponse.json({error:"Failed to process request"},{status:500})}}let y=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/system-status/route",pathname:"/api/system-status",filename:"route",bundlePath:"app/api/system-status/route"},resolvedPagePath:"D:\\Projects Base Web Dev\\Final YR New Project Idea\\New_Scrapping_Project\\ethical-shopping-platform\\frontend\\src\\app\\api\\system-status\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:S,staticGenerationAsyncStorage:w,serverHooks:g}=y,v="/api/system-status/route";function D(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:w})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[916,786],()=>s(2716));module.exports=a})();