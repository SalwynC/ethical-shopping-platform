"use strict";(()=>{var e={};e.id=847,e.ids=[847],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},568:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>f,patchFetch:()=>w,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>S,staticGenerationAsyncStorage:()=>y});var r={};a.r(r),a.d(r,{GET:()=>g,POST:()=>d,dynamic:()=>c,runtime:()=>l});var s=a(3277),n=a(5265),o=a(5356),i=a(7076);let c="force-dynamic",l="nodejs",u=[],p=0;async function d(e){let t=performance.now();try{let a=await e.json();if("track_analysis"===a.action){let r=`analysis_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s=e.headers.get("x-session-id")||"anonymous",n=e.headers.get("user-agent")||"unknown",o={id:r,timestamp:new Date().toISOString(),productUrl:a.productData.url,productTitle:a.productData.title||"Unknown Product",category:a.productData.category||"general",ethicalScore:a.analysisResults?.ethicalScore,processingTime:Math.round(performance.now()-t),userAgent:n,sessionId:s};return u.push(o),p++,u.length>1e3&&(u=u.slice(-1e3)),await fetch(`${e.nextUrl.origin}/api/system-status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"record_analysis"})}),i.NextResponse.json({success:!0,message:"Product analysis tracked successfully",data:{analysisId:r,totalAnalyses:p,timestamp:o.timestamp,processingTime:o.processingTime}})}return i.NextResponse.json({error:'Invalid action. Use "track_analysis"'},{status:400})}catch(e){return i.NextResponse.json({success:!1,error:"Failed to track product analysis",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function g(e){try{let t=new URL(e.url),a=parseInt(t.searchParams.get("limit")||"10"),r=t.searchParams.get("category"),s=u;r&&(s=u.filter(e=>e.category.toLowerCase().includes(r.toLowerCase())));let n=s.slice(-a).reverse().map(e=>({id:e.id,timestamp:e.timestamp,productTitle:e.productTitle,category:e.category,ethicalScore:e.ethicalScore,processingTime:e.processingTime})),o={totalAnalyses:p,analysesToday:u.filter(e=>new Date(e.timestamp).toDateString()===new Date().toDateString()).length,averageProcessingTime:u.length>0?Math.round(u.reduce((e,t)=>e+t.processingTime,0)/u.length):0,categoriesAnalyzed:Array.from(new Set(u.map(e=>e.category))).length,averageEthicalScore:u.filter(e=>void 0!==e.ethicalScore).length>0?Math.round(u.filter(e=>void 0!==e.ethicalScore).reduce((e,t)=>e+(t.ethicalScore||0),0)/u.filter(e=>void 0!==e.ethicalScore).length):null};return i.NextResponse.json({success:!0,data:{statistics:o,recentAnalyses:n,totalRecords:s.length},meta:{timestamp:new Date().toISOString(),dataSource:"real-analysis-tracking"}})}catch(e){return i.NextResponse.json({success:!1,error:"Failed to retrieve analysis data",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/track-analysis/route",pathname:"/api/track-analysis",filename:"route",bundlePath:"app/api/track-analysis/route"},resolvedPagePath:"D:\\Projects Base Web Dev\\Final YR New Project Idea\\New_Scrapping_Project\\ethical-shopping-platform\\frontend\\src\\app\\api\\track-analysis\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:y,serverHooks:S}=m,f="/api/track-analysis/route";function w(){return(0,o.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:y})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[916,786],()=>a(568));module.exports=r})();