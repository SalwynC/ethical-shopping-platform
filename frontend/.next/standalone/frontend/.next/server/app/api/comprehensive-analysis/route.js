"use strict";(()=>{var e={};e.id=810,e.ids=[810],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1152:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>M,patchFetch:()=>v,requestAsyncStorage:()=>f,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>y});var r={};a.r(r),a.d(r,{GET:()=>m,POST:()=>h});var o=a(3277),n=a(5265),i=a(5356),s=a(7076);let c=[],l={};async function d(e,t,a=3){let r=null;for(let o=0;o<a;o++)try{let a=new AbortController,r=setTimeout(()=>a.abort(),3e4),o=await fetch(e,{...t,signal:a.signal});return clearTimeout(r),o}catch(e){if(r=e,o<a-1){let e=1e3*Math.pow(2,o);await new Promise(t=>setTimeout(t,e))}}throw Error(`Failed to connect to backend after ${a} attempts. Last error: ${r?.message} (${r?.code})`)}async function h(e){try{let{action:t,productData:a,analysisResults:r}=await e.json();if("comprehensive_analysis"===t){let e=null;try{let t=await d("http://localhost:4000/api/analyze",{method:"POST",headers:{"Content-Type":"application/json",Connection:"keep-alive",Accept:"application/json"},body:JSON.stringify({url:a.url})},3);t.ok?e=await t.json():await t.text()}catch(e){}let t={productData:{url:a.url,title:e?.productInfo?.title||a.title,brand:e?.productInfo?.brand||function(e){let t=new URL(e).hostname;return({"amazon.com":"Amazon Marketplace","nike.com":"Nike","adidas.com":"Adidas","apple.com":"Apple","walmart.com":"Walmart","target.com":"Target"})[t]||`Brand from ${t}`}(a.url),category:e?.productInfo?.category||function(e,t){let a=t.toLowerCase();return a.includes("shirt")||a.includes("clothing")?"clothing":a.includes("shoe")||a.includes("sneaker")?"footwear":a.includes("phone")||a.includes("iphone")?"electronics":a.includes("coffee")||a.includes("food")?"food":"general"}(a.url,a.title),price:e?.priceTrend?.current||function(e){let[t,a]={clothing:[20,200],footwear:[50,300],electronics:[100,1500],food:[5,50],general:[10,100]}[e]||[10,100];return Math.floor(Math.random()*(a-t)+t)}(a.category),currency:e?.priceTrend?.currency||"INR",marketplace:new URL(a.url).hostname,availability:e?.productInfo?.availability||"in_stock"},marketResearch:{competitorAnalysis:{similarProducts:Math.floor(50*Math.random())+10,averageMarketPrice:Math.floor(200*Math.random())+50,pricePosition:Math.random()>.5?"below_market":"above_market",marketShare:15*Math.random()+5},trendAnalysis:{popularityScore:Math.floor(100*Math.random())+1,trendDirection:["rising","stable","declining"][Math.floor(3*Math.random())],seasonality:function(){let e=new Date().getMonth();return e>=11||e<=1?"Winter/Holiday Peak":e>=2&&e<=4?"Spring Collection":e>=5&&e<=7?"Summer Season":"Fall/Back-to-School"}(),demandForecast:Math.floor(200*Math.random())+50}},ethicalAssessment:{overallScore:e?.ethicalScore||r?.ethicalScore||Math.floor(100*Math.random())+1,laborPractices:{score:e?.sustainability?.brandRating||Math.floor(100*Math.random())+1,certifications:["Fair Trade Certified","GOTS Organic","B-Corp Certified","Carbon Neutral","WRAP Certified","ISO 14001","OEKO-TEX Standard"].filter(()=>Math.random()>.6),workingConditions:["excellent","good","fair","poor"][Math.floor(4*Math.random())],fairWages:Math.random()>.4},environmentalImpact:{score:e?.sustainability?.ethicalSourcing||Math.floor(100*Math.random())+1,carbonFootprint:100*Math.random(),sustainabilityRating:e?.sustainability?.environmentalImpact||["A","B","C","D","F"][Math.floor(5*Math.random())],recyclable:Math.random()>.3,packagingScore:Math.floor(100*Math.random())+1},supplychainTransparency:{score:Math.floor(100*Math.random())+1,traceability:Math.floor(100*Math.random())+1,sourcingEthics:Math.floor(100*Math.random())+1}},riskAssessment:{overallRisk:["low","medium","high"][Math.floor(3*Math.random())],factorsAnalyzed:["Supply chain stability","Brand reputation","Price volatility","Market competition","Regulatory compliance"],warningFlags:["Limited supply chain transparency","Recent price volatility","Mixed customer reviews","Unclear return policy","Environmental concerns reported"].filter(()=>Math.random()>.7),recommendations:["Monitor price changes for better deals","Check for seasonal discounts","Consider ethical alternatives","Verify product authenticity","Read recent customer reviews"]},timeBasedAnalytics:{analysisTimestamp:new Date().toISOString(),processingTime:Math.floor(3e3*Math.random())+1e3,dataFreshness:24*Math.random(),nextUpdateRecommended:new Date(Date.now()+864e5).toISOString()},historicalContext:{priceHistory:function(){let e=[];for(let t=30;t>=0;t--){let a=new Date;a.setDate(a.getDate()-t),e.push({date:a.toISOString(),price:Math.floor(50*Math.random())+50,source:Math.random()>.5?"retailer":"third_party"})}return e}(),reviewTrends:{totalReviews:Math.floor(5e3*Math.random())+100,averageRating:2*Math.random()+3,ratingTrend:["improving","stable","declining"][Math.floor(3*Math.random())],fakesDetected:Math.floor(50*Math.random())},brandReputation:{reputationScore:Math.floor(100*Math.random())+1,controversies:["Labor practices questioned in 2023","Environmental lawsuit settled","Supply chain audit findings"].filter(()=>Math.random()>.8),positiveNews:["Sustainability initiative launched","Fair wage program implemented","Carbon neutrality achieved","Community partnership established"]}},alternativesRecommendations:[{title:"Ethical Alternative Product A",url:"https://example.com/alternative-1",ethicalScore:Math.floor(30*Math.random())+70,priceComparison:40*Math.random()-20,reasonForRecommendation:"Better labor practices and environmental impact"},{title:"Sustainable Option B",url:"https://example.com/alternative-2",ethicalScore:Math.floor(25*Math.random())+75,priceComparison:30*Math.random()-15,reasonForRecommendation:"Fair trade certified with transparent supply chain"}]};return c.unshift(t),["24h","7d","30d","90d","6m","1y"].forEach(e=>{l[e]||(l[e]=p(e));let a=l[e];a.metrics.totalAnalyses+=1,a.metrics.uniqueProducts+=1;let r=t.productData.category,o=a.metrics.topCategories.find(e=>e.category===r);o||(o={category:r,count:0,averageScore:0},a.metrics.topCategories.push(o)),o.count+=1,o.averageScore=(o.averageScore+t.ethicalAssessment.overallScore)/2}),s.NextResponse.json({success:!0,analysis:t,message:"Comprehensive analysis completed successfully"})}return s.NextResponse.json({success:!0,message:"Analysis tracked successfully"})}catch(e){return s.NextResponse.json({error:"Failed to perform comprehensive analysis"},{status:500})}}async function m(e){try{let t=new URL(e.url),a=t.searchParams.get("period")||"30d",r=t.searchParams.get("analysisId");if(r){let e=c.find(e=>e.timeBasedAnalytics.analysisTimestamp===r);if(!e)return s.NextResponse.json({error:"Analysis not found"},{status:404});return s.NextResponse.json({analysis:e})}let o=l[a]||p(a);return s.NextResponse.json({period:a,statistics:o,recentAnalyses:c.slice(0,10),totalAnalyses:c.length,lastUpdated:new Date().toISOString()})}catch(e){return s.NextResponse.json({error:"Failed to fetch analytics data"},{status:500})}}function p(e){return{period:e,metrics:{totalAnalyses:Math.floor(100*Math.random())+50,uniqueProducts:Math.floor(80*Math.random())+40,averageEthicalScore:Math.floor(30*Math.random())+60,topCategories:[{category:"clothing",count:25,averageScore:72},{category:"electronics",count:18,averageScore:68},{category:"footwear",count:15,averageScore:75}],marketTrends:{priceInflation:10*Math.random()-5,ethicalImprovement:15*Math.random()+5,popularBrands:["Nike","Patagonia","Apple","Adidas"]}}}}let u=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/comprehensive-analysis/route",pathname:"/api/comprehensive-analysis",filename:"route",bundlePath:"app/api/comprehensive-analysis/route"},resolvedPagePath:"D:\\Projects Base Web Dev\\Final YR New Project Idea\\New_Scrapping_Project\\ethical-shopping-platform\\frontend\\src\\app\\api\\comprehensive-analysis\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:y,serverHooks:g}=u,M="/api/comprehensive-analysis/route";function v(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:y})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[916,786],()=>a(1152));module.exports=r})();